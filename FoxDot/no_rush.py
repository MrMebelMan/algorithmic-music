# https://soundcloud.com/kitty_clock/no-rush

Clock.bpm = 80

# Custom SynthDefs
dab = SynthDef('dab')
rhodes = SynthDef('rhodes')
supersaw = SynthDef('supersaw')
tworgan = SynthDef('tworgan')
varcell = SynthDef('varcell')
beatbass = SynthDef('beatbass')
benoit = SynthDef('benoit')
bphase = SynthDef('bphase')
flute = SynthDef('flute')
hoover = SynthDef('hoover')
kalimba = SynthDef('kalimba')
mhping = SynthDef('mhping')

###########################################################################

kl >> kalimba(-5, oct=4.5, dur=0.5, amp=var([1, 0], [[128, 64, 32], 64, 64, 32]) * var([1, 0], [31, 1]) * 0.5)
bb >> beatbass(dur=var([1, 2], [256, [64, 32]]), sus=0.05, oct=4.05,
    amp=var([0, 1], [128, 64, 128, 128, 64, 256]) * var([0.75, 0, 0.5, 0, 0.85], [128, 32, 128, 64, 64, 32, 64, 128, 128, 128, 64, 64, 32, 64, 32])
)
b2 >> beatbass(dur=bb.dur, delay=0.5, sus=0.03, oct=4,
    amp=P[
        [var([1, 0.5, 1, 0.25], 32), 0], [var([0.25, 1, 0.5, 1], 64), 0.25, 0, 0], var([0.15, 0.25, 0.5, 0.75], 16), [var([0.75, 0.25, 0.5, 1], 8), 0, 0, 0.25], [0.25, 0.5], 0.5
    ] * (bb.amp * 0.75) * var([0, 1], [32, 64, 64, 128, 32, 128])
)
db >> dab(
    P[var([1, 0.5, 0, -0.5], 32), var([0, 0.5, 0.75, 0.25], 8), [0.5, 0.25], [0.25, 0, 0.25, 0.15]],
    dur=0.25, delay=var([0, 0.5, 0.25, 0], 32), lpf=expvar([100, 1000], [128, 0]), oct=5,
    amp=P[
        var([1, 0.6], [64, 32, 64]), var([0.5, 0.25, 0.75, 1, 0.85, 0.5], 32), var([0.75, 0.25, 0.5, 0.75, 0.25], 8), var([0.25, 0.75, 0.25, 0.5], 64)
    ] * var([1, 0], [[64, 32], 32, 32, 64, [128, 64, 32], 64, 64, 128])
)
tm >> play('m', rate=var([0.9, 1, 0.95, 1.05, 0.85], [32, 64]), dur=1, amp=expvar([0, 0, 1.5, 1.5], [[64, 32], [64, 32], [128, 256], 0])).every(128, 'stutter', 2)
sh >> play('s', sample=var([0, 1, 2, 3], 64), dur=1, delay=0.5, amp=var([0, 1], [64, 128, 32, 64]) * 1.5)

bd >> play('V',
    rate=P[1, 0.98, 1, var([0.96, 0.93], 128)] + var([[0, -0.1, -0.2], 0.05, -0.05, -0.1, 0.05, -0.15], [32, 16, 16, 8, 8, 64, 32, 32]),
    sample=var([2, 1, 0, 2], [64, 128, 32]), dur=1,
    lpf=var([3000, 4000, 2500, 4500, 3500], [64, 128, 32, 32]), lpr=0.25,
    amp=expvar([0, 2, 2], [[1024, 256, 128, 64], [128, 64, 32, 256], 0]) * var([1, 0], [31, 1, 28, 4, 31, 1, 56, 8]) * var([0, 1], [256, 128, 128, 256, 64, 128, 32, 64, 64, 256]),
    bend=var([0, 0.05], 32),
).every([128, 64], 'stutter', 2)

Group(o2, o3, kk, m2, rk, o1, bl, rc).stop()

h1 >> play('-', room=1, mix=0.15,
    sample=var([0, 1, 2, 0, 2], [32, [128, 64, 32], 32, 64, 64, 128]), dur=1, delay=0.5,
    amp=var([0, 1], [64, [128, 64, 32], 32, [64, 32], [32, 64], [128, 64]]) * 2
).every(32, 'stutter', 2)
h2 >> play('-',
    sample=int(var([0, 1, 2, 0, 2], [32, 32, 64, 64, 128])),
    dur=1, delay=0.75,
    amp=P[[1, var([0, 1], [32, 64, 32])], var([1, 0.75, 0.5, 0.25], 32), var([1, 0.5], 8), 1] * var([0, 0.85], [64, 128, 128]) * h1.amp
)
rs >> play('I', sample=var([1, 0], 64), lpf=2000, lpr=0.25, dur=var([8, 4, 2], [256, 128, [64, 128]]),
    amp=expvar([0, 0, 2, 2], [[64, 128, 256, 32, 64], [32, 64, 128, 64], [128, 64, 128, 32, 64, 128], 0])
)
tb >> play('t', room=1, mix=PRand([0.25, 0, 0.15, 0.1, 0.2]),
    sample=P[0, var([1, 0, 2], 32), var([2, 0, 1, 1], [16, 8]), var([0, 1])],
    dur=0.25,
    rate=P[1, [0.85, 0.9], [1, 0.9, 1, 0.8], 1],
    lpf=P[1, [var([0.5, 1], 32), 0.85, 1, 0.95], [0.85, 1], [1, 1, 0.95, 0.9]] * expvar([1500, 6000], [[64, 32], 0, [32, 128], 0]),
    lpr=0.25,
    amp=P[1, [0.5, 1], [0.25, 0.5, 0.75, 1], [1, 0.85]] * var([1, 0], [31, 1, 28, 4, 31, 1, 31, 1]) * 1.75
)
#tb.sample = 1
bl >> sawbass(dur=0.25, sus=1, chop=4,
    hpf=P[
        var([1, 0.5, 0.75, 0.25, 0.85], [32, 16, 8, 8]),
        [var([0.75, 0.5, 0.25, 1], 4), 0.8, var([1, 0.5, 1, 0.25], [8, 16]), 0.9],
        [0.9, var([1, 0.5])],
        [var([0.9, 0.25, 0.5, 0.75], [32, 16]), 0.8, 0.7, 1]
    ] * var([800, 400, 600, 200, 300, 900, 600], [4, 2, 3, 1]),
    hpr=0.25, amp=P[[0.5, 0.25, 0.5, 0.75], [0.25, 0.25, 0.5, 0.5], [1, 0.75], 0.3] * var([0, 1.5], [64, 128, [64, 128, 256], [256, 128, 64, 32]]))
s2 >> play('s', pan=PWhite(-0.85, 0.85), sample=PRand([0, 1, 2], 2), dur=0.25, amp=var([0, 1], [[32, 64, 128], [64, 128, 32], 64, 128, 32, 128]) * var([1, 0], [31, 1, 28, 4]) * 1.25)
o1 >> play('o',
    sample=var([0, 1], [56, 8, 56, 8, 28, 4, 28, 4, 31, 1, 31, 1]),
    rate=(0, [0.25, 0.35]),
    dur=var([2, 1], [256, 128, 128, 64, 64, 32]),
    amp=P[var([1, 1.15, 0.75], [32, 64]), [0.75, var([0.5, 0.75], 64)]] * var([0, 1], [32, [64, 128, 32], [64, 32], 64, 32, [128, 64, 32]]) * 1.35
)
o2 >> play('j',
    rate=P[1.5, 1.6] * var([1, 0.85, 1, 0.9, 1, 0.8], [[64, 128, 256], 32, 16, 8, 8, 4, 4, 4, 4]),
    drive=1.5, cut=0.25, sample=var([2, 1, 0], 32),
    dur=P[var([1.5, 0.5, 1, 2], 128), var([0.25, 0.25, 1, 2], 128), var([0.25, 0.5, 1, 2], 128)],
    delay=1,
    amp=P[1, 0.75] * var([0, 0.5], [[128, 256], [64, 128], 64, [128, 64], 32, 64, [32, 64], [128, 64]])
)
o3 >> play('j', rate=o2.rate, drive=1, cut=0.15, sample=var([1, 2, 0, 3, 1, 2], [[32, 64], [32, 64, 128]]), dur=o2.dur * int(var([1, 2], 64)), delay=1.5, amp=P[1, 0.75] * o2.amp * 0.5)
rc >> play('~', sample=var([0, 1], 256), pan=PWhite(-0.75, 0.75), dur=0.25, lpf=expvar([1500, 2000, 7000], [[128, 64, 32], [32, 64, 128], 0]), lpr=0.25, amp=var([2, 0], [256, 128, 128, 64, 128, 32]))
fs >> play('O',
    pan=PWhite(-0.75, 0.75),
    lpf=expvar([2000, 5000], [[128, 64, 32], 0]) * var([1, 0.75], [28, 4, 31, 1, 56, 8]), lpr=0.25,
    sample=var([1, 2], 32) + int(var([0, 1, -1], [16, 8, 4, 4])), room=1, mix=PRand([0.15, 0, 0.25, 0.1], [8, 4, 2, 2]), dur=0.25, rate=var([0.75, 0.8, 0.7, 0.95, 0.85], [32, 16, 16, 64, 32]), cut=0.5,
    amp=P[
        1, [0.5, var([1, 0], 16)], [0.25, var([0.75, 0], 8), var([1, 0.25], [64, 32]), 0.85], [0.25, var([0.5, 0], [64, 128, 32, 32]), 0.25, 0.75]
    ] * expvar([0, 0, 1, 1], [[64, 32, 128, 64, 32, 256], [128, 64, 32], [128, 64, 32, 128], 0])
)
kk >> play('k', dur=var([4, 8, 4, 4, 2], [64, 128, 32, 32]), delay=0.5, amp=var([0, 3], [64, 32, 128, 32, 32, 16, 16, 16, 16, 8, 8, 8, 8, 4, 4, 4, 4]))
rk >> play('X', sample=2, dur=1, delay=0.25, rate=-1, bend=1, lpf=1000, lpr=0.25, amp=bd.amp * var([0, 1], [128, [256, 128, 64], 64, [128, 64], 32, 64]) * 0.3)
m2 >> mhping(
    var([0, -0.5, 0.25, -1], 64),
    dur=var([0.5, 0.25], [512, 256, 256, 128, 64, 128, 128, 256]),
    oct=var([5, 6, 5, 4.85], 64),
    chop=var([2, 0], 128), lpf=700, lpr=0.85,
    amp=P[[1, 0.85], var([0.25, 0.5, 0.75, 1], 32)] * var([0, 1], [1024, 512, 256, 128, 128, 64]) * 0.95
)
